\documentclass[a4paper,10pt]{article}
\usepackage[left=15mm,right=15mm,top=35mm,bottom=15mm,headheight=22mm]{geometry}
\usepackage{amsmath,amssymb}
\usepackage{booktabs}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{parskip}

% ── Colours ──────────────────────────────────────────────────
\definecolor{passgreen}{HTML}{2E7D32}
\definecolor{failred}{HTML}{C62828}
\definecolor{headblue}{HTML}{1565C0}
\definecolor{ruleblue}{HTML}{90CAF9}

\newcommand{\pass}{\textcolor{passgreen}{\textbf{PASS}}}
\newcommand{\fail}{\textcolor{failred}{\textbf{FAIL}}}

% ── Section formatting ───────────────────────────────────────
\titleformat{\section}
  {\small\bfseries\color{headblue}}{}{0em}{}
  [\vspace{-0.4em}{\color{ruleblue}\rule{\columnwidth}{0.3pt}}]
\titlespacing*{\section}{0pt}{6pt}{2pt}

% ── Page header ──────────────────────────────────────────────
\pagestyle{fancy}
\fancyhf{}
\lhead{%
  \BLOCK{if has_logo}%
  \includegraphics[height=14mm]{\VAR{logo_filename}}%
  \BLOCK{else}%
  \raisebox{2mm}{\textbf{\large\color{headblue}formandfunction}}%
  \BLOCK{endif}%
}
\rhead{%
  \scriptsize%
  \begin{tabular}[b]{@{}r@{\,}l@{\quad}r@{\,}l@{}}
    \textbf{Project:} & \VAR{project_title} & \textbf{Calcs by:} & \VAR{calcs_by} \\
    \textbf{Job No:} & \VAR{job_no} & \textbf{Checked:} & \VAR{checked_by} \\
    \textbf{Calcs for:} & \VAR{calcs_for} & \textbf{Approved:} & \VAR{approved_by} \\
  \end{tabular}%
}
\renewcommand{\headrulewidth}{0.5pt}
\cfoot{\scriptsize Page~\thepage}

% ── Layout ───────────────────────────────────────────────────
\setlength{\columnsep}{4mm}
\setlength{\parindent}{0pt}
\setlength{\parskip}{1.5pt}

\begin{document}

% ══════════════════════════════════════════════════════════════
%  Title
% ══════════════════════════════════════════════════════════════
\begin{center}
  {\normalsize\bfseries\color{headblue} Steel Column Design to Eurocode 3}\\[1pt]
  {\footnotesize EN 1993-1-1:2005}\\[3pt]
  {\small\bfseries \VAR{designation} \;---\; \VAR{steel_grade}}\\[1pt]
  {\small $N_{Ed} = \VAR{NEd}$\,kN \qquad $M_{y,Ed} = \VAR{My_Ed}$\,kNm \qquad $M_{z,Ed} = \VAR{Mz_Ed}$\,kNm}
\end{center}
\vspace{-1mm}
{\color{headblue}\hrule height 0.5pt}
\vspace{3mm}

% ══════════════════════════════════════════════════════════════
%  Section Properties (full width)
% ══════════════════════════════════════════════════════════════
{\small\bfseries\color{headblue} Section Properties}
\vspace{-1mm}

{\color{ruleblue}\rule{\textwidth}{0.3pt}}
\vspace{1mm}

\begin{center}
\footnotesize
\begin{tabular}{@{}ll@{\quad}ll@{\quad}ll@{\quad}ll@{}}
\toprule
$h$        & \VAR{h}\,mm      & $b$        & \VAR{b}\,mm      & $t_w$      & \VAR{tw}\,mm     & $t_f$      & \VAR{tf}\,mm \\
$r$        & \VAR{r}\,mm      & $d$        & \VAR{d}\,mm      & $A$        & \VAR{A_sec}\,cm$^2$ & $G$     & \VAR{mass}\,kg/m \\
\midrule
$I_y$      & \VAR{Iy}\,cm$^4$ & $I_z$      & \VAR{Iz_sec}\,cm$^4$ & $I_t$  & \VAR{It}\,cm$^4$ & $I_w$      & \VAR{Iw}\,cm$^6$ \\
$W_{el,y}$ & \VAR{Wel_y}\,cm$^3$ & $W_{pl,y}$ & \VAR{Wpl_y}\,cm$^3$ & $W_{el,z}$ & \VAR{Wel_z}\,cm$^3$ & $W_{pl,z}$ & \VAR{Wpl_z}\,cm$^3$ \\
\bottomrule
\end{tabular}
\end{center}
\vspace{2mm}

% ══════════════════════════════════════════════════════════════
%  3-Column Design Checks (Steps 1–7)
% ══════════════════════════════════════════════════════════════
\begin{multicols}{3}
\small

% ── Step 1 ──────────────────────────────────────────────────
\section{Step 1: Yield Strength}
{\footnotesize\itshape Table 3.1}

\VAR{steel_grade},\; $t_f = \VAR{tf}$\,mm

$f_y = \VAR{fy}$\,N/mm$^2$

$\varepsilon = \sqrt{235/\VAR{fy}} = \VAR{epsilon}$

% ── Step 2 ──────────────────────────────────────────────────
\section{Step 2: Classification}
{\footnotesize\itshape Table 5.2 (compression + bending)}

\textbf{Flange} (outstand):

$c = (b{-}t_w)/2{-}r = \VAR{c_flange}$\,mm

$c/t = \VAR{ct_flange}$

$9\varepsilon = \VAR{fl_9e}$
$\;\Rightarrow$ \textbf{Class \VAR{flange_class}}

\medskip
\textbf{Web} (internal, $\alpha = \VAR{alpha_web}$):

$c/t = \VAR{c_web}/\VAR{tw} = \VAR{ct_web}$

$\Rightarrow$ \textbf{Class \VAR{web_class}}

\medskip
\fbox{\textbf{Overall: Class \VAR{section_class}}}

% ── Step 3 ──────────────────────────────────────────────────
\section{Step 3: Axial Resistance}
{\footnotesize\itshape \S\,6.2.4}

$N_{Rd} = A \cdot f_y / \gamma_{M0}$

$= \VAR{A_sec}{\times}10^2{\times}\VAR{fy} / 10^3$

$= \VAR{NRd}$\,kN

\medskip
$N_{Ed}/N_{Rd} = \VAR{axial_util}$\;
\BLOCK{if axial_ok}\pass\BLOCK{else}\fail\BLOCK{endif}

% ── Step 4 ──────────────────────────────────────────────────
\section{Step 4: Bending Resistance}
{\footnotesize\itshape \S\,6.2.5}

\BLOCK{if section_class <= 2}%
Class \VAR{section_class} $\rightarrow W_{pl}$
\BLOCK{else}%
Class 3 $\rightarrow W_{el}$
\BLOCK{endif}

$M_{y,Rd} = W_y f_y / \gamma_{M0} = \VAR{My_Rd}$\,kNm

$M_{z,Rd} = W_z f_y / \gamma_{M0} = \VAR{Mz_Rd}$\,kNm

% ── Step 5 ──────────────────────────────────────────────────
\section{Step 5: Shear Resistance}
{\footnotesize\itshape \S\,6.2.6}

$A_v = \VAR{Av}$\,mm$^2$

$V_{pl,Rd} = A_v(f_y/\!\sqrt{3}) / \gamma_{M0}$

$= \VAR{Vpl_Rd}$\,kN

\medskip
$V_{Ed}/V_{pl,Rd} = \VAR{shear_util}$\;
\BLOCK{if shear_ok}\pass\BLOCK{else}\fail\BLOCK{endif}

% ── Step 6 ──────────────────────────────────────────────────
\section{Step 6: Combined (Cons.)}
{\footnotesize\itshape \S\,6.2.1(7)}

$\frac{N_{Ed}}{N_{Rd}} + \frac{M_{y,Ed}}{M_{y,Rd}} + \frac{M_{z,Ed}}{M_{z,Rd}} \leq 1.0$

\medskip
Utilisation $= \VAR{conservative_util}$\;
\BLOCK{if conservative_ok}\pass\BLOCK{else}\fail\BLOCK{endif}

% ── Step 7 ──────────────────────────────────────────────────
\section{Step 7: Combined (Alt.)}
{\footnotesize\itshape \S\,6.2.9.1}

$a_w = \VAR{a_w}$

$M_{N,y,Rd} = \VAR{MN_y_Rd}$\,kNm

$M_{N,z,Rd} = \VAR{MN_z_Rd}$\,kNm

$\alpha = \VAR{alpha_interact}$,\;
$\beta = \VAR{beta_interact}$

\medskip
$\left[\frac{M_{y,Ed}}{M_{N,y,Rd}}\right]^\alpha + \left[\frac{M_{z,Ed}}{M_{N,z,Rd}}\right]^\beta$

$= \VAR{alternative_util}$\;
\BLOCK{if alternative_ok}\pass\BLOCK{else}\fail\BLOCK{endif}

\end{multicols}

\vspace{2mm}

% ══════════════════════════════════════════════════════════════
%  Step 8: Flexural Buckling (full width)
% ══════════════════════════════════════════════════════════════
\section{Step 8: Flexural Buckling}
{\footnotesize\itshape \S\,6.3.1}
\vspace{2mm}

\small
$\lambda_1 = 93.9\varepsilon = \VAR{lambda_1}$

\vspace{2mm}
\begin{center}
\footnotesize
\begin{tabular}{@{}lcccccccc@{}}
\toprule
\textbf{Axis} & $L_{cr}$\,(m) & $i$\,(mm) & $\bar{\lambda}$ & Curve & $\alpha$ & $\Phi$ & $\chi$ \\
\midrule
$y$-$y$ & \VAR{Lcr_y} & \VAR{iy_mm} & \VAR{lambda_bar_y} & \VAR{curve_y} & \VAR{alpha_y} & \VAR{Phi_y} & \VAR{chi_y} \\
$z$-$z$ & \VAR{Lcr_z} & \VAR{iz_mm} & \VAR{lambda_bar_z} & \VAR{curve_z} & \VAR{alpha_z} & \VAR{Phi_z} & \VAR{chi_z} \\
\bottomrule
\end{tabular}
\end{center}

\vspace{1mm}
$N_{b,Rd} = \chi_{\min} \cdot A \cdot f_y / \gamma_{M1} = \VAR{Nb_Rd}$\,kN
\qquad
$N_{Ed}/N_{b,Rd} = \VAR{NEd}/\VAR{Nb_Rd}$\;
\BLOCK{if buckling_ok}\pass\BLOCK{else}\fail\BLOCK{endif}

\vspace{4mm}

% ══════════════════════════════════════════════════════════════
%  Step 9: LTB (full width)
% ══════════════════════════════════════════════════════════════
\section{Step 9: Lateral Torsional Buckling}
{\footnotesize\itshape \S\,6.3.2.3 --- Rolled sections method}
\vspace{2mm}

\small
$h/b = \VAR{h_over_b_disp}$\;
\BLOCK{if h_over_b <= 2.0}$\leq 2$\BLOCK{else}$> 2$\BLOCK{endif}\;
$\Rightarrow$ Curve \textbf{\VAR{curve_LT}},\;
$\alpha_{LT} = \VAR{alpha_LT}$

$M_{cr} = \VAR{Mcr}$\,kNm \qquad
$\bar{\lambda}_{LT} = \VAR{lambda_LT}$ \qquad
$\chi_{LT} = \VAR{chi_LT}$

$M_{b,Rd} = \chi_{LT} \cdot W_y \cdot f_y / \gamma_{M1} = \VAR{Mb_Rd}$\,kNm

\vspace{4mm}

% ══════════════════════════════════════════════════════════════
%  Step 10: Combined Buckling — Annex A (full width)
% ══════════════════════════════════════════════════════════════
\section{Step 10: Combined Buckling --- Annex A}
{\footnotesize\itshape \S\,6.3.3, Expressions 6.61/6.62}
\vspace{2mm}

\small
\textbf{Critical forces:}\;
$N_{cr,y} = \VAR{Ncr_y}$\,kN,\;
$N_{cr,z} = \VAR{Ncr_z}$\,kN,\;
$N_{cr,T} = \VAR{Ncr_T}$\,kN

\medskip
\textbf{Moment factors} ($\psi_y = \VAR{psi_y}$, $\psi_z = \VAR{psi_z}$):\;
$C_{my} = \VAR{Cmy}$,\;
$C_{mz} = \VAR{Cmz}$,\;
$C_{mLT} = \VAR{CmLT}$

\medskip
$a_{LT} = \VAR{aLT}$

\medskip
\textbf{Interaction factors:}

\vspace{1mm}
\begin{center}
\footnotesize
\begin{tabular}{@{}cccc@{}}
\toprule
$k_{yy}$ & $k_{yz}$ & $k_{zy}$ & $k_{zz}$ \\
\midrule
\VAR{kyy} & \VAR{kyz} & \VAR{kzy} & \VAR{kzz} \\
\bottomrule
\end{tabular}
\end{center}

\vspace{2mm}
\textbf{Expression 6.61:}

$\displaystyle\frac{N_{Ed}}{\chi_y N_{Rk}/\gamma_{M1}} + k_{yy}\frac{M_{y,Ed}}{\chi_{LT} M_{y,Rk}/\gamma_{M1}} + k_{yz}\frac{M_{z,Ed}}{M_{z,Rk}/\gamma_{M1}} = \VAR{eq6_61}$\;
\BLOCK{if eq6_61 is string}---\BLOCK{elif eq6_61|float <= 1.0}\pass\BLOCK{else}\fail\BLOCK{endif}

\medskip
\textbf{Expression 6.62:}

$\displaystyle\frac{N_{Ed}}{\chi_z N_{Rk}/\gamma_{M1}} + k_{zy}\frac{M_{y,Ed}}{\chi_{LT} M_{y,Rk}/\gamma_{M1}} + k_{zz}\frac{M_{z,Ed}}{M_{z,Rk}/\gamma_{M1}} = \VAR{eq6_62}$\;
\BLOCK{if eq6_62 is string}---\BLOCK{elif eq6_62|float <= 1.0}\pass\BLOCK{else}\fail\BLOCK{endif}

\vspace{4mm}

% ══════════════════════════════════════════════════════════════
%  Summary
% ══════════════════════════════════════════════════════════════
\section{Design Summary}
\vspace{2mm}

\begin{center}
\footnotesize
\begin{tabular}{@{}lrrrl@{}}
\toprule
\textbf{Check} & \textbf{Capacity} & \textbf{Demand} & \textbf{Util.} & \\
\midrule
Axial (\S\,6.2.4)          & $N_{Rd} = \VAR{NRd}$\,kN  & $N_{Ed} = \VAR{NEd}$\,kN  & \VAR{axial_util} & \BLOCK{if axial_ok}\pass\BLOCK{else}\fail\BLOCK{endif} \\
Shear (\S\,6.2.6)          & $V_{pl,Rd} = \VAR{Vpl_Rd}$\,kN & $V_{Ed} = \VAR{VEd}$\,kN & \VAR{shear_util} & \BLOCK{if shear_ok}\pass\BLOCK{else}\fail\BLOCK{endif} \\
Combined cons.\ (\S\,6.2.1) & \multicolumn{2}{c}{$N/N_{Rd}+M_y/M_{y,Rd}+M_z/M_{z,Rd}$} & \VAR{conservative_util} & \BLOCK{if conservative_ok}\pass\BLOCK{else}\fail\BLOCK{endif} \\
Combined alt.\ (\S\,6.2.9)  & \multicolumn{2}{c}{$[M_y/M_{N,y}]^\alpha+[M_z/M_{N,z}]^\beta$} & \VAR{alternative_util} & \BLOCK{if alternative_ok}\pass\BLOCK{else}\fail\BLOCK{endif} \\
Flex.\ buckling (\S\,6.3.1) & $N_{b,Rd} = \VAR{Nb_Rd}$\,kN & $N_{Ed} = \VAR{NEd}$\,kN & --- & \BLOCK{if buckling_ok}\pass\BLOCK{else}\fail\BLOCK{endif} \\
Eq.\,6.61 (Annex A)         & \multicolumn{2}{c}{Interaction} & \VAR{eq6_61} & \BLOCK{if eq6_61|float <= 1.0}\pass\BLOCK{else}\fail\BLOCK{endif} \\
Eq.\,6.62 (Annex A)         & \multicolumn{2}{c}{Interaction} & \VAR{eq6_62} & \BLOCK{if eq6_62|float <= 1.0}\pass\BLOCK{else}\fail\BLOCK{endif} \\
\midrule
\multicolumn{4}{@{}l}{\textbf{OVERALL}} & \BLOCK{if overall_ok}\pass\BLOCK{else}\fail\BLOCK{endif} \\
\bottomrule
\end{tabular}
\end{center}

\end{document}
