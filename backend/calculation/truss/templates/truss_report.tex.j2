\documentclass[a4paper,10pt]{article}
\usepackage[left=15mm,right=15mm,top=35mm,bottom=15mm,headheight=22mm]{geometry}
\usepackage{amsmath,amssymb}
\usepackage{booktabs}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{multicol}
\usepackage{graphicx}
\usepackage{titlesec}
\usepackage{parskip}
% ── Colours ──────────────────────────────────────────────────
\definecolor{passgreen}{HTML}{2E7D32}
\definecolor{failred}{HTML}{C62828}
\definecolor{headblue}{HTML}{1565C0}
\definecolor{ruleblue}{HTML}{90CAF9}

% ── Section formatting ───────────────────────────────────────
\titleformat{\section}
  {\small\bfseries\color{headblue}}{}{0em}{}
  [\vspace{-0.4em}{\color{ruleblue}\rule{\columnwidth}{0.3pt}}]
\titlespacing*{\section}{0pt}{6pt}{2pt}

% ── Page header ──────────────────────────────────────────────
\pagestyle{fancy}
\fancyhf{}
\lhead{%
  \BLOCK{if has_logo}%
  \includegraphics[height=14mm]{\VAR{logo_filename}}%
  \BLOCK{else}%
  \raisebox{2mm}{\textbf{\large\color{headblue}formandfunction}}%
  \BLOCK{endif}%
}
\rhead{%
  \scriptsize%
  \begin{tabular}[b]{@{}r@{\,}l@{\quad}r@{\,}l@{}}
    \textbf{Project:} & \VAR{project_title} & \textbf{Calcs by:} & \VAR{calcs_by} \\
    \textbf{Job No:} & \VAR{job_no} & \textbf{Checked:} & \VAR{checked_by} \\
    \textbf{Calcs for:} & \VAR{calcs_for} & \textbf{Approved:} & \VAR{approved_by} \\
  \end{tabular}%
}
\renewcommand{\headrulewidth}{0.5pt}
\cfoot{\scriptsize Page~\thepage}

% ── Layout ───────────────────────────────────────────────────
\setlength{\columnsep}{4mm}
\setlength{\parindent}{0pt}
\setlength{\parskip}{1.5pt}

\begin{document}

% ══════════════════════════════════════════════════════════════
%  Title
% ══════════════════════════════════════════════════════════════
\begin{center}
  {\normalsize\bfseries\color{headblue} Truss Analysis Report}\\[3pt]
  {\small\bfseries \VAR{truss_name}}\\[1pt]
  {\small Span\,=\,\VAR{span}\,m \qquad Depth\,=\,\VAR{depth}\,m}
\end{center}
\vspace{-1mm}
{\color{headblue}\hrule height 0.5pt}
\vspace{3mm}

% ══════════════════════════════════════════════════════════════
%  Geometry & Material Summary
% ══════════════════════════════════════════════════════════════
\section{Model Summary}

\begin{center}
\footnotesize
\begin{tabular}{@{}ll@{\qquad}ll@{\qquad}ll@{}}
\toprule
\textbf{Nodes}   & \VAR{n_nodes}  &
\textbf{Members} & \VAR{n_members} &
\textbf{Span}    & \VAR{span}\,m \\
\textbf{$E$}     & \VAR{E_GPa}\,GPa &
\textbf{$A$}     & \VAR{A_cm2}\,cm$^2$ &
\textbf{Depth}   & \VAR{depth}\,m \\
\bottomrule
\end{tabular}
\end{center}
\vspace{2mm}

% ══════════════════════════════════════════════════════════════
%  Member Forces
% ══════════════════════════════════════════════════════════════
\section{Member Forces}

\begin{center}
\footnotesize
\begin{tabular}{@{}llrrl@{}}
\toprule
\textbf{Member} & \textbf{Nodes} & \textbf{Length\,(m)} & \textbf{Axial\,(kN)} & \textbf{Type} \\
\midrule
\BLOCK{for m in members}%
\VAR{m.name} & \VAR{m.nodes} & \VAR{m.length} & \VAR{m.axial} & \VAR{m.tc} \\
\BLOCK{endfor}%
\bottomrule
\end{tabular}
\end{center}
\vspace{2mm}

% ══════════════════════════════════════════════════════════════
%  Reactions & Displacements (side by side)
% ══════════════════════════════════════════════════════════════
\begin{multicols}{2}

\section{Support Reactions}

\begin{center}
\footnotesize
\begin{tabular}{@{}lrrr@{}}
\toprule
\textbf{Node} & $F_x$\,(kN) & $F_y$\,(kN) & $M_z$\,(kNm) \\
\midrule
\BLOCK{for r in reactions}%
\VAR{r.node} & \VAR{r.fx} & \VAR{r.fy} & \VAR{r.mz} \\
\BLOCK{endfor}%
\bottomrule
\end{tabular}
\end{center}

\columnbreak

\section{Node Displacements}

\begin{center}
\footnotesize
\begin{tabular}{@{}lrrr@{}}
\toprule
\textbf{Node} & $d_x$\,(mm) & $d_y$\,(mm) & $r_z$\,(rad) \\
\midrule
\BLOCK{for d in displacements}%
\VAR{d.node} & \VAR{d.dx} & \VAR{d.dy} & \VAR{d.rz} \\
\BLOCK{endfor}%
\bottomrule
\end{tabular}
\end{center}

\end{multicols}

% ══════════════════════════════════════════════════════════════
%  Plots
% ══════════════════════════════════════════════════════════════
\BLOCK{if plot_filenames}%
\section{Analysis Plots}
\vspace{2mm}

\begin{center}
\BLOCK{for pf in plot_filenames}%
\includegraphics[width=0.48\textwidth]{\VAR{pf}}%
\BLOCK{if not loop.last}%
\BLOCK{if loop.index is divisibleby 2}%

\vspace{3mm}
\BLOCK{else}%
\hfill
\BLOCK{endif}%
\BLOCK{endif}%
\BLOCK{endfor}%
\end{center}
\BLOCK{endif}%

\end{document}
